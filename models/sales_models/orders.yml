models:
  - name: orders
    meta: 
      primary_key: order_id
      description: "Orders placed in our CRM"
      joins:
        - join: promotion_redemptions
          sql_on: ${orders.order_id} = ${promotion_redemptions.order_id}
          type: left
          relationship: one-to-many
        - join: promotions
          sql_on: ${promotion_redemptions.promotion_id} = ${promotions.promotion_id}
          type: left
          relationship: many-to-one
    columns:
      - name: order_id
        description: ""
        meta:
          dimension:
            type: number
      - name: order_date
        description: ""
        meta:
          dimension:
            type: timestamp
      - name: user_id
        description: ""
        meta:
          dimension:
            type: number
      - name: partner_id
        description: ""
        meta:
          dimension:
            type: number
      - name: ordered_product_skus
        description: ""
        meta:
          dimension:
            type: string
      - name: currency
        description: ""
        meta:
          dimension:
            type: string
      - name: basket_total
        description: ""
        meta:
          dimension:
            type: number
          metrics:
            total_order_revenue:
              type: sum
              description: The total revenue from all orders
            percent_of_order_revenue:
              type: percent_of_total
              description: The percentage of total revenue from this order
              sql: ${total_order_revenue}
            running_total_order_revenue:
              type: running_total
              description: The running total of order revenue over time
              sql: ${total_order_revenue}
      - name: profit
        description: ""
        meta:
          dimension:
            type: number
      - name: referrer
        description: ""
        meta:
          dimension:
            type: string
