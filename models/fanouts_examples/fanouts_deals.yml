version: 2
models:
  - name: fanouts_deals
    columns:
      - name: deal_id
        description: "Unique identifier for this deal"
        meta:
          dimension:
            type: string
          metrics:
            unique_deals:
              type: count_distinct
              label: "‚úÖ Unique Deal Count"
              description: "‚úÖ CORRECT: Count distinct deals"

            inflated_deal_count:
              type: count
              label: "üö® INFLATED Deal Count"
              description: "‚ùå WRONG: Each deal gets multiplied by (users √ó events) in that
                account"

      - name: account_id
        description: "Links to the account table"
        meta:
          dimension:
            type: string

      - name: stage
        description: "Current stage of the deal"
        meta:
          dimension:
            type: string

      - name: safe_total_deal_value
        description: "Deal value in dollars, safe from fanout inflation"
        meta:
          dimension:
            type: number
            label: "‚úÖ FANOUT SAFE Deal Total Amount"
      - name: amount
        description: "Deal value in dollars"
        meta:
          dimension:
            type: number
          metrics:
            inflated_total_deal_value:
              label: "üö® INFLATED Total Deal Value"
              description: "‚ùå WRONG: Deal amounts get multiplied by (users √ó events). A $1000
                deal becomes $1000 √ó users √ó events!"
              format: 'usd'
              type: sum

            inflated_average_deal_value:
              type: average
              label: "üö® INFLATED Average Deal Value"
              description: "‚ùå WRONG: Average is calculated on inflated rows, not actual deals"
              format: 'usd'

      - name: created_date
        description: "When the deal was created"
        meta:
          dimension:
            type: date
      - name: plan
        description: ""
        meta:
          dimension:
            type: string
      - name: seats
        description: ""
        meta:
          dimension:
            type: number
